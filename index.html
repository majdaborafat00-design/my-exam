<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Linux Administration Exam</title>
    <style>
        :root { --primary: #1a73e8; --secondary: #6c757d; --success: #28a745; --bg: #f4f7f6; }
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background-color: var(--bg); margin: 0; padding: 20px; display: flex; justify-content: center; }
        .quiz-container { width: 100%; max-width: 850px; background: white; padding: 40px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); position: relative; }
        
        /* إخفاء الأقسام والأسئلة افتراضياً */
        .section, .question-step { display: none; }
        .active { display: block; animation: fadeIn 0.4s; }

        h1 { text-align: center; color: var(--primary); border-bottom: 2px solid var(--primary); padding-bottom: 10px; }
        .timer-bar { position: sticky; top: 0; background: var(--primary); color: white; padding: 10px; text-align: center; border-radius: 8px; font-weight: bold; margin-bottom: 20px; display: none; z-index: 100; }
        
        .question-box { padding: 25px; border: 1px solid #eee; border-radius: 12px; background: #fff; margin-bottom: 20px; }
        .question-text { font-weight: bold; font-size: 1.2rem; margin-bottom: 20px; display: block; line-height: 1.6; color: #202124; }
        
        .options label { display: block; padding: 15px; margin: 10px 0; cursor: pointer; border: 1px solid #ddd; border-radius: 8px; transition: 0.3s; }
        .options label:hover { background: #f1f3f4; }
        .options input[type="radio"]:checked + span { font-weight: bold; color: var(--primary); }
        .options input { margin-right: 15px; transform: scale(1.3); }
        
        .essay-area { width: 100%; height: 200px; padding: 15px; border: 1px solid #ccc; border-radius: 8px; font-family: 'Courier New', monospace; box-sizing: border-box; }
        
        .nav-buttons { display: flex; justify-content: space-between; margin-top: 30px; border-top: 1px solid #eee; padding-top: 20px; }
        button { padding: 12px 35px; border: none; border-radius: 6px; cursor: pointer; font-size: 1rem; font-weight: bold; }
        .btn-next { background: var(--primary); color: white; }
        .btn-prev { background: var(--secondary); color: white; }
        .btn-submit { background: var(--success); color: white; }
        button:disabled { background: #ccc; cursor: not-allowed; }

        .progress { text-align: center; margin-top: 15px; font-weight: bold; color: #5f6368; }
        input[type="text"], input[type="password"] { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ccc; border-radius: 6px; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="quiz-container">
    <div id="timer" class="timer-bar">Time Remaining: 90:00</div>

    <form id="quizForm" action="https://formspree.io/f/xaqddprd" method="POST">
        
        <div id="section-login" class="section active">
            <h1>Linux Exam Login</h1>
            <div style="padding: 20px 0;">
                <label><b>Student Name:</b></label>
                <input type="text" name="student_name" id="student_name" required placeholder="Enter your full name">
                <label><b>Access Code:</b></label>
                <input type="password" placeholder="Enter code (Optional)">
            </div>
            <button type="button" class="btn-next" style="width: 100%;" onclick="startExam()">Enter Exam</button>
        </div>

        <div id="section-questions" class="section">
            
            <div class="question-step active" id="step-1">
                <div class="question-box">
                    <span class="question-text">1. Consider the following output from a Linux terminal session:<br><code>[me@linuxbox ~]$ kaekfjaeifj bash</code><br><code>kaekfjaeifj: command not found</code><br><br>Which explaination is technically accurate?</span>
                    <div class="options">
                        <label><input type="radio" name="q1" value="A"> <span>A) The system failed due to missing sudo privileges to /root.</span></label>
                        <label><input type="radio" name="q1" value="B"> <span>B) The command is a disabled built-in shell function.</span></label>
                        <label><input type="radio" name="q1" value="C"> <span>C) Shell searched $PATH and failed to find an executable file or lacks permission.</span></label>
                        <label><input type="radio" name="q1" value="D"> <span>D) The CPU architecture is incompatible with the binary.</span></label>
                    </div>
                </div>
            </div>

            <div class="question-step" id="step-2">
                <div class="question-box">
                    <span class="question-text">2. A user named "me" tries <code>cd /data/secure/</code>. The folder is owned by "me" (700), but the parent <code>/data/</code> is (000) owned by root. What happens?</span>
                    <div class="options">
                        <label><input type="radio" name="q2" value="A"> <span>A) System uses sudo automatically.</span></label>
                        <label><input type="radio" name="q2" value="B"> <span>B) Command fails (Permission denied) - cannot pass through /data/.</span></label>
                        <label><input type="radio" name="q2" value="C"> <span>C) Succeeds, but files inside are invisible.</span></label>
                        <label><input type="radio" name="q2" value="D"> <span>D) Succeeds because user owns the sub-folder.</span></label>
                    </div>
                </div>
            </div>

            <div class="question-step" id="step-3">
                <div class="question-box">
                    <span class="question-text">3. What is the behavior of <code>ls /bin /nonexistent_folder</code>?</span>
                    <div class="options">
                        <label><input type="radio" name="q3" value="A"> <span>A) Fails entirely with no output.</span></label>
                        <label><input type="radio" name="q3" value="B"> <span>B) Creates the folder automatically.</span></label>
                        <label><input type="radio" name="q3" value="C"> <span>C) Lists /bin first, then shows error for the missing folder.</span></label>
                        <label><input type="radio" name="q3" value="D"> <span>D) Only displays an error message.</span></label>
                    </div>
                </div>
            </div>

            <div class="question-step" id="step-22">
                <div class="question-box">
                    <span class="question-text">22. Scenario: Filter 'CRITICAL' lines from tasks.log, save count to final_report.txt, set permissions (Owner/Group RW), and delete /projects/data. Write the commands:</span>
                    <textarea name="q22_essay" class="essay-area" placeholder="Type your Linux commands and explanation here..."></textarea>
                </div>
            </div>

            <div class="question-step" id="step-24">
                <div class="question-box">
                    <span class="question-text">24. Modify permissions: Add execute for owner, and set group/others to read/write only (removing old execute).</span>
                    <div class="options">
                        <label><input type="radio" name="q24" value="A"> <span>A) chmod u+x,go=rw file.txt</span></label>
                        <label><input type="radio" name="q24" value="B"> <span>B) chmod u-x,go-rw file.txt</span></label>
                        <label><input type="radio" name="q24" value="C) chmod a+x file.txt"> <span>C) chmod a+x file.txt</span></label>
                        <label><input type="radio" name="q24" value="D) chmod o-rw file.txt"> <span>D) chmod o-rw file.txt</span></label>
                    </div>
                </div>
            </div>

            <div class="progress" id="progress-text">Question 1 of 24</div>

            <div class="nav-buttons">
                <button type="button" class="btn-prev" id="prevBtn" onclick="changeQuestion(-1)" disabled>Previous</button>
                <button type="button" class="btn-next" id="nextBtn" onclick="changeQuestion(1)">Next</button>
                <button type="submit" class="btn-submit" id="submitBtn" style="display: none;">Submit Final Exam</button>
            </div>
        </div>
    </form>
</div>

<script>
    let currentStep = 1;
    const totalSteps = 24; // عدّلها حسب عدد الأسئلة الكلي

    function startExam() {
        const name = document.getElementById('student_name').value;
        if (!name) { alert("Please enter your name!"); return; }
        
        document.getElementById('section-login').classList.remove('active');
        document.getElementById('section-questions').classList.add('active');
        document.getElementById('timer').style.display = 'block';
        runTimer(90 * 60);
    }

    function changeQuestion(n) {
        // التحقق من أن الطالب اختار إجابة قبل الذهاب للسؤال التالي
        if (n === 1) {
            const currentQ = document.getElementById('step-' + currentStep);
            const radios = currentQ.querySelectorAll('input[type="radio"]');
            const area = currentQ.querySelector('textarea');
            let checked = false;
            
            if (radios.length > 0) {
                radios.forEach(r => { if(r.checked) checked = true; });
            } else if (area) {
                if (area.value.trim() !== "") checked = true;
            }

            if (!checked) { alert("Please provide an answer before moving forward."); return; }
        }

        // إخفاء الحالي وإظهار الجديد
        document.getElementById('step-' + currentStep).classList.remove('active');
        currentStep += n;
        document.getElementById('step-' + currentStep).classList.add('active');

        // تحديث الأزرار والنصوص
        document.getElementById('prevBtn').disabled = (currentStep === 1);
        document.getElementById('progress-text').innerText = `Question ${currentStep} of ${totalSteps}`;
        
        if (currentStep === totalSteps) {
            document.getElementById('nextBtn').style.display = 'none';
            document.getElementById('submitBtn').style.display = 'inline-block';
        } else {
            document.getElementById('nextBtn').style.display = 'inline-block';
            document.getElementById('submitBtn').style.display = 'none';
        }
    }

    function runTimer(sec) {
        const timerDiv = document.getElementById('timer');
        const interval = setInterval(() => {
            const m = Math.floor(sec / 60);
            const s = sec % 60;
            timerDiv.innerText = `Time Remaining: ${m}:${s < 10 ? '0'+s : s}`;
            if (sec <= 0) {
                clearInterval(interval);
                alert("Time is over! Sending your answers.");
                document.getElementById('quizForm').submit();
            }
            sec--;
        }, 1000);
    }
</script>

</body>
</html>
